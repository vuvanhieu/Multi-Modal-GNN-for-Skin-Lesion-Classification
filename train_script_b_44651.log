===== NVIDIA-SMI =====
Sat Sep  6 01:22:37 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 560.35.03              Driver Version: 560.35.03      CUDA Version: 12.6     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA A100-SXM4-80GB          On  |   00000000:47:00.0 Off |                    0 |
| N/A   25C    P0             58W /  400W |       1MiB /  81920MiB |      0%      Default |
|                                         |                        |             Disabled |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
======================
Loading pytorch-extra-py39-cuda11.2-gcc9/1.9.1
  Loading requirement: openblas/dynamic/0.3.18 hdf5_18/1.8.21 gcc9/9.5.0
    python39 cuda11.2/toolkit/11.2.2 cudnn8.1-cuda11.2/8.1.1.33
    ml-pythondeps-py39-cuda11.2-gcc9/4.8.1 nccl2-cuda11.2-gcc9/2.14.3
    pytorch-py39-cuda11.2-gcc9/1.9.1
Loading tensorflow2-py39-cuda11.2-gcc9/2.7.0
  Loading requirement: protobuf3-gcc9/3.9.2
Executing job script_b (ID=44651): python 14_module_GNN_HAM10000_s5_2/main.py
[DEBUG] metadata_df columns: ['lesion_id', 'image_id', 'dx', 'dx_type', 'age', 'sex', 'localization']
[DEBUG] metadata_df['dx'] head: ['bkl', 'bkl', 'bkl', 'bkl', 'bkl', 'bkl', 'bkl', 'bkl', 'bkl', 'bkl']

=== Running: GFDCG | GNN=gcn | Fusion=gating | LGC=False ===
Features: ['densenet121_features', 'densenet169_features', 'densenet201_features'] | Clinical=True
[DEBUG] train_paths: {'VASC': {'densenet121_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet121_features/VASC', 'densenet169_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet169_features/VASC', 'densenet201_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet201_features/VASC'}, 'DF': {'densenet121_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet121_features/DF', 'densenet169_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet169_features/DF', 'densenet201_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet201_features/DF'}, 'BKL': {'densenet121_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet121_features/BKL', 'densenet169_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet169_features/BKL', 'densenet201_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet201_features/BKL'}, 'AKIEC': {'densenet121_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet121_features/AKIEC', 'densenet169_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet169_features/AKIEC', 'densenet201_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet201_features/AKIEC'}, 'BCC': {'densenet121_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet121_features/BCC', 'densenet169_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet169_features/BCC', 'densenet201_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet201_features/BCC'}, 'NV': {'densenet121_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet121_features/NV', 'densenet169_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet169_features/NV', 'densenet201_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet201_features/NV'}, 'MEL': {'densenet121_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet121_features/MEL', 'densenet169_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet169_features/MEL', 'densenet201_features': '/data2/cmdir/home/hieuvv/IMAGES/data2/data2_HAM10000_FEATURES/densenet201_features/MEL'}, 'unlabeled': {}}
[DEBUG] test_paths: {}
[DEBUG] Loading features for feature_type: densenet121_features
[DEBUG] X_base shape: (10015, 1024), y_train shape: (10015,)
[DEBUG] y_train unique labels: {0, 1, 2, 3, 4, 5, 6}
[DEBUG] Pre-check rows -> X_base: 10015, X_clinical: 10015
Fold 1
Traceback (most recent call last):
  File "/data2/cmdir/home/hieuvv/IMAGES/14_module_GNN_HAM10000_s5_2/main.py", line 202, in <module>
    main()
  File "/data2/cmdir/home/hieuvv/IMAGES/14_module_GNN_HAM10000_s5_2/main.py", line 156, in main
    _, baseline_metrics = run_experiment(
  File "/data2/cmdir/home/hieuvv/IMAGES/14_module_GNN_HAM10000_s5_2/train.py", line 126, in run_experiment
    raise ValueError("X_clinical và X phải có cùng số mẫu!")
ValueError: X_clinical và X phải có cùng số mẫu!
Job complete.
